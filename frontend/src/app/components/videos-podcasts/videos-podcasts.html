<div class="videos-podcasts-container">
  <!-- Header: breadcrumb + title (left) and navigation buttons (right) -->
  <header class="header-generic-content" role="banner">
    <div class="header-left">
      <div class="breadcrumb">
        <a aria-label="MÃ³dulo pai">{{ moduleEmoji ? (moduleEmoji + ' ') : '' }}{{ moduleLabel || 'MÃ³dulo' }}</a>
      </div>

      <!-- Page Title + stats (moved here to match conceitos layout) -->
      <div class="page-title-and-stats">
        <h2>ğŸ¬ VÃ­deos & Podcasts</h2>
        <div class="stats" *ngIf="!isLoading">
          <span class="stat-item">
            <strong>{{ getStats().totalVideos }}</strong> vÃ­deos
          </span>
          <span class="stat-item">
            <strong>{{ getStats().totalAudios }}</strong> podcasts
          </span>
          <span class="stat-item">
            <strong>{{ bibliografiasMedia.length }}</strong> {{ bibliografiasMedia.length === 1 ? 'bibliografia' : 'bibliografias' }}
          </span>
        </div>
      </div>
    </div>

    <!-- BotÃµes de navegaÃ§Ã£o (similar ao componente capa-bibliografia) -->
    <nav class="navigation-buttons" aria-label="NavegaÃ§Ã£o" *ngIf="!isLoading">
      <button class="btn btn-stroked" (click)="navigateTo(getPath('bibliografia'))" aria-label="Voltar para Bibliografia">
        â¬…ï¸ Voltar Ã  Bibliografia
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('flash-cards'))" aria-label="Flashcards">
        ğŸ“‡ Flashcards
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('perguntas'))" aria-label="Perguntas">
        â“ Perguntas
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('conceitos'))" aria-label="Conceitos">
        ğŸ§­ Conceitos
      </button>
    </nav>
  </header>

  <!-- Filtros -->
  <div class="filters-section" *ngIf="!isLoading">
    <div class="filter-row">
      <!-- Filtro de Bibliografia -->
      <div class="filter-group" *ngIf="bibliografiasMedia.length > 1">
        <label for="bibliografia-filter">ğŸ“– Bibliografia:</label>
        <select 
          id="bibliografia-filter"
          [(ngModel)]="selectedBibliografiaId"
          (ngModelChange)="onBibliografiaChange()"
          class="filter-select">
          <option [ngValue]="null">Todas as Bibliografias</option>
          <option 
            *ngFor="let bib of bibliografiasMedia" 
            [ngValue]="bib.bibliografiaId">
            {{ bib.bibliografiaTitulo }}
          </option>
        </select>
      </div>

      <!-- Busca -->
      <div class="filter-group">
        <label for="search-filter">ğŸ” Buscar:</label>
        <input 
          type="text"
          id="search-filter"
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchChange()"
          placeholder="Buscar por tÃ­tulo ou descriÃ§Ã£o..."
          class="filter-input">
      </div>
    </div>

    <!-- BotÃ£o de limpar filtros -->
    <div class="actions-row" *ngIf="selectedBibliografiaId || searchTerm">
      <button 
        class="btn btn-outline"
        (click)="resetFilters()">
        âœ–ï¸ Limpar Filtros
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Carregando mÃ­dias...</p>
  </div>

  <!-- Tabs -->
  <div class="tabs-container" *ngIf="!isLoading">
    <div class="tabs-header">
      <button 
        class="tab-button"
        [class.active]="activeTab === TabType.VIDEOS"
        (click)="setActiveTab(TabType.VIDEOS)">
        ğŸ¥ VÃ­deos ({{ capitulosComVideo.length }})
      </button>
      <button 
        class="tab-button"
        [class.active]="activeTab === TabType.PODCASTS"
        (click)="setActiveTab(TabType.PODCASTS)">
        ğŸ™ï¸ Podcasts ({{ capitulosComAudio.length }})
      </button>
    </div>

    <!-- Tab Content: VÃ­deos -->
    <div class="tab-content" *ngIf="activeTab === TabType.VIDEOS">
      <div class="media-grid" *ngIf="capitulosComVideo.length > 0">
        <div 
          *ngFor="let capitulo of capitulosComVideo; trackBy: trackByCapituloId"
          class="media-card">
          <div class="media-card-header">
            <h3 class="media-title">
              <span class="ordem-badge" *ngIf="capitulo.ordem">{{ capitulo.ordem }}.</span>
              {{ capitulo.titulo }}
            </h3>
            <span class="duracao" *ngIf="capitulo.duracao">
              â±ï¸ {{ capitulo.duracao }}
            </span>
          </div>

          <div class="media-player">
            <video 
              [id]="'video-' + capitulo.id"
              [src]="capitulo.videoPath"
              controls
              controlsList="nodownload"
              (play)="onVideoPlay(capitulo.id)"
              class="video-element">
              Seu navegador nÃ£o suporta o elemento de vÃ­deo.
            </video>
          </div>

          <div class="media-card-footer" *ngIf="capitulo.descricao || getCapituloBibliografia(capitulo)">
            <p class="media-description" *ngIf="capitulo.descricao">
              {{ capitulo.descricao }}
            </p>
            <small class="media-bibliografia" *ngIf="getCapituloBibliografia(capitulo)">
              ğŸ“š {{ getCapituloBibliografia(capitulo)?.bibliografiaTitulo }}
            </small>
          </div>
        </div>
      </div>

      <!-- Empty State VÃ­deos -->
      <div class="empty-state" *ngIf="capitulosComVideo.length === 0">
        <div class="empty-icon">ğŸ¥</div>
        <h3>Nenhum vÃ­deo disponÃ­vel</h3>
        <p *ngIf="searchTerm || selectedBibliografiaId">
          Tente ajustar os filtros.
        </p>
        <p *ngIf="!searchTerm && !selectedBibliografiaId">
          NÃ£o hÃ¡ vÃ­deos cadastrados para as bibliografias selecionadas.
        </p>
      </div>
    </div>

    <!-- Tab Content: Podcasts -->
    <div class="tab-content" *ngIf="activeTab === TabType.PODCASTS">
      <div class="media-list" *ngIf="capitulosComAudio.length > 0">
        <div 
          *ngFor="let capitulo of capitulosComAudio; trackBy: trackByCapituloId"
          class="audio-card">
          <div class="audio-card-header">
            <div class="audio-info">
              <h3 class="audio-title">
                <span class="ordem-badge" *ngIf="capitulo.ordem">{{ capitulo.ordem }}.</span>
                {{ capitulo.titulo }}
              </h3>
              <p class="audio-description" *ngIf="capitulo.descricao">
                {{ capitulo.descricao }}
              </p>
            </div>
            <span class="duracao" *ngIf="capitulo.duracao">
              â±ï¸ {{ capitulo.duracao }}
            </span>
          </div>

          <div class="audio-player">
            <audio 
              [id]="'audio-' + capitulo.id"
              [src]="capitulo.audioPath"
              controls
              controlsList="nodownload"
              (play)="onAudioPlay(capitulo.id)"
              class="audio-element">
              Seu navegador nÃ£o suporta o elemento de Ã¡udio.
            </audio>
          </div>

          <div class="audio-card-footer" *ngIf="getCapituloBibliografia(capitulo)">
            <small class="audio-bibliografia">
              ğŸ“š {{ getCapituloBibliografia(capitulo)?.bibliografiaTitulo }}
            </small>
          </div>
        </div>
      </div>

      <!-- Empty State Podcasts -->
      <div class="empty-state" *ngIf="capitulosComAudio.length === 0">
        <div class="empty-icon">ğŸ™ï¸</div>
        <h3>Nenhum podcast disponÃ­vel</h3>
        <p *ngIf="searchTerm || selectedBibliografiaId">
          Tente ajustar os filtros.
        </p>
        <p *ngIf="!searchTerm && !selectedBibliografiaId">
          NÃ£o hÃ¡ podcasts cadastrados para as bibliografias selecionadas.
        </p>
      </div>
    </div>
  </div>

  <!-- No Data State -->
  <div class="empty-state" *ngIf="!isLoading && bibliografiasMedia.length === 0">
    <div class="empty-icon">ğŸ“­</div>
    <h3>Nenhuma mÃ­dia configurada</h3>
    <p>NÃ£o hÃ¡ vÃ­deos ou podcasts cadastrados.</p>
  </div>
</div>
