<div class="main-container">
  <div class="header">
        <h2>ðŸ§  Mapa Mental</h2>
  </div>       

    <div class="mapa-mental">
    
        <div *ngIf="loading" class="loading">Carregando...</div>
        <div *ngIf="error" class="error">{{ error }}</div>

        <ul class="roots" *ngIf="!loading && nodes.length">
            <li *ngFor="let root of nodes" class="root">
                                <div class="root-title" (click)="onNodeClick(root, true)">
                                    <span class="title-label" title="{{ root.title }}" [ngStyle]="{ 'background-color': levelBg(root.level) }" [class.expanded]="isExpanded(root.id)" [class.has-children]="root.children?.length" [attr.aria-label]="root.children?.length ? ('ContÃ©m ' + root.children?.length + ' filhos') : 'Sem filhos'">
                                        <span class="title-text">{{ root.title }}</span>
                                        <span *ngIf="root.children?.length" class="child-indicator">{{ root.children?.length }}</span>
                                    </span>
                                </div>
                <ul class="children" *ngIf="isExpanded(root.id)">
                    <ng-container *ngTemplateOutlet="nodeList; context: { $implicit: root.children }"></ng-container>
                </ul>
            </li>
        </ul>

        <ng-template #nodeList let-nodes>
            <li *ngFor="let node of nodes" class="node">
                                <div class="node-title" (click)="$event.stopPropagation(); onNodeClick(node)">
                                    <span class="title-label" title="{{ node.title }}" [ngStyle]="{ 'background-color': levelBg(node.level) }" [class.expanded]="isExpanded(node.id)" [class.has-children]="node.children?.length" [attr.aria-label]="node.children?.length ? ('ContÃ©m ' + node.children?.length + ' filhos') : 'Sem filhos'">
                                        <span class="title-text">{{ node.title }}</span>
                                        <span *ngIf="node.children?.length" class="child-indicator">{{ node.children?.length }}</span>
                                    </span>
                                </div>
                <ul *ngIf="node.children?.length && isExpanded(node.id)" class="children">
                    <ng-container *ngTemplateOutlet="nodeList; context: { $implicit: node.children }"></ng-container>
                </ul>
            </li>
        </ng-template>
    </div>
</div>