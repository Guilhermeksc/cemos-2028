<!-- Container principal com Material Card -->
<mat-card class="conceitos-card">

  <!-- Conteúdo da tabela -->
  <mat-card-content class="card-content">
    <!-- Estado vazio -->
    <div class="empty-state" *ngIf="conceitos.length === 0">
      <mat-icon class="empty-icon">description</mat-icon>
      <p class="empty-message">{{ emptyMessage }}</p>
    </div>

    <!-- Tabela Material -->
    <div class="table-container" *ngIf="conceitos.length > 0">
      <table mat-table [dataSource]="conceitos" class="conceitos-table">
        
        <!-- Coluna Assunto -->
        <ng-container matColumnDef="assunto">
          <th mat-header-cell *matHeaderCellDef class="header-cell assunto-header">
            Assunto
          </th>
          <td mat-cell *matCellDef="let conceito" class="assunto-cell">
            <div class="assunto-content">
              <span class="assunto-text" *ngIf="conceito.assunto">
                {{ conceito.assunto }}
              </span>
              <span class="no-assunto" *ngIf="!conceito.assunto">
                Sem assunto
              </span>
            </div>
          </td>
        </ng-container>
                
        <!-- Coluna Título -->
        <ng-container matColumnDef="titulo">
          <th mat-header-cell *matHeaderCellDef class="header-cell titulo-header">
            Título
          </th>
          <td mat-cell *matCellDef="let conceito" class="titulo-cell">
            <div class="titulo-content">
              <span class="titulo-text">{{ conceito.titulo }}</span>
            </div>
          </td>
        </ng-container>

        <!-- Coluna Descrição -->
        <ng-container matColumnDef="descricao">
          <th mat-header-cell *matHeaderCellDef class="header-cell descricao-header">
            Descrição
          </th>
          <td mat-cell *matCellDef="let conceito" class="descricao-cell">
            <div class="descricao-content" *ngIf="hasDescricao(conceito)">
              <p class="descricao-text">{{ getTruncatedDescricao(conceito.descricao!, 200) }}</p>
            </div>
            <div class="no-descricao" *ngIf="!hasDescricao(conceito)">
              <span class="no-descricao-text">Sem descrição</span>
            </div>
          </td>
        </ng-container>

        <!-- Coluna Bibliografia -->
        <ng-container matColumnDef="bibliografia" *ngIf="showBibliografia">
          <th mat-header-cell *matHeaderCellDef class="header-cell bibliografia-header">
            Bibliografia
          </th>
          <td mat-cell *matCellDef="let conceito" class="bibliografia-cell">
            <div class="bibliografia-content">
              <span class="bibliografia-titulo" *ngIf="conceito.bibliografia_titulo">
                {{ conceito.bibliografia_titulo }}
              </span>
              <span class="bibliografia-id" *ngIf="!conceito.bibliografia_titulo">
                Bibliografia #{{ conceito.bibliografia }}
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Coluna Palavra-chave -->
        <ng-container matColumnDef="palavra-chave">
          <th mat-header-cell *matHeaderCellDef class="header-cell palavra-chave-header">
            Palavra-chave
          </th>
          <td mat-cell *matCellDef="let conceito" class="palavra-chave-cell">
            <div class="palavra-chave-content">
              <span class="palavra-chave-text" *ngIf="conceito.palavra_chave">
                {{ conceito.palavra_chave }}
              </span>
              <span class="no-palavra-chave" *ngIf="!conceito.palavra_chave">
                Sem palavra-chave
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Coluna Prova -->
        <ng-container matColumnDef="prova">
          <th mat-header-cell *matHeaderCellDef class="header-cell prova-header">
            Prova
          </th>
          <td mat-cell *matCellDef="let conceito" class="prova-cell">
            <div class="prova-content">
              <!-- Caiu em prova -->
              <mat-chip-set *ngIf="conceito.caiu_em_prova">
                <mat-chip 
                  [class]="conceito.ano_prova ? 'prova-chip-confirmada' : 'prova-chip-pendente'"
                  matTooltip="{{ getCaiuEmProvaText(conceito) }}">
                  <mat-icon matChipTrailingIcon>star</mat-icon>
                  {{ getCaiuEmProvaText(conceito) || 'Sim' }}
                </mat-chip>
              </mat-chip-set>
              
              <!-- Não caiu em prova -->
              <span class="no-prova" *ngIf="!conceito.caiu_em_prova">
                <mat-icon class="no-prova-icon">remove</mat-icon>
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Definir linhas -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
            class="table-row"
            [attr.data-conceito-id]="row.id"></tr>
      </table>
    </div>
  </mat-card-content>
</mat-card>