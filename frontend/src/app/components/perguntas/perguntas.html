<!-- Simulado de Perguntas - Layout Simplificado -->
<div class="simulado-container-simplified">
  
  <!-- Loading das QuestÃµes -->
  <div *ngIf="isLoadingQuestions" class="loading-questions">
    <div class="loading-spinner"></div>
    <p>Carregando prova...</p>
  </div>

  <!-- Prova Carregada -->
  <div *ngIf="questionsLoaded && !isLoadingQuestions" class="prova-loaded">
    
    <!-- Header da Prova -->
    <div class="prova-header">
      <div class="prova-info">
        <h2>ğŸ“ Prova - {{ simuladoQuestions.length }} QuestÃµes</h2>
        <div class="prova-stats">
          <span class="stat">Respondidas: {{ getTotalAnsweredQuestions() }}/{{ simuladoQuestions.length }}</span>
          <span class="stat">Acertos: {{ getTotalCorrectAnswers() }}</span>
          <span class="stat" [class.good-score]="getScorePercentage() >= 70">
            Performance: {{ getScorePercentage().toFixed(1) }}%
          </span>
        </div>
      </div>
      
      <button 
        class="btn btn-secondary gerar-nova-prova-btn"
        (click)="gerarNovaProva()"
        [disabled]="isLoadingQuestions"
      >
        ğŸ”„ Gerar Nova Prova
      </button>
    </div>

    <!-- Lista de QuestÃµes -->
    <div class="questoes-list">
      <div 
        *ngFor="let question of simuladoQuestions; let i = index" 
        class="questao-item"
        [class.answered]="question.uniqueKey && isQuestionAnswered(question.uniqueKey)"
        [class.correct]="question.uniqueKey && getQuestionAnswerStatus(question.uniqueKey) === 'correct'"
        [class.incorrect]="question.uniqueKey && getQuestionAnswerStatus(question.uniqueKey) === 'incorrect'"
      >
        
        <!-- CabeÃ§alho da QuestÃ£o -->
        <div class="questao-header">
          <div class="questao-numero">
            <span class="numero">{{ i + 1 }}</span>
            <span class="tipo-badge" [class]="'tipo-' + question.tipo">
              {{ question.tipo === 'vf' ? 'V/F' : 
                 question.tipo === 'multipla' ? 'MÃºltipla' : 'CorrelaÃ§Ã£o' }}
            </span>
          </div>
          
          <div class="questao-info">
            <span *ngIf="question.bibliografia_titulo" class="bibliografia">
              ğŸ“š {{ question.bibliografia_titulo }}
            </span>
            <span *ngIf="question.paginas" class="paginas">
              ğŸ“„ PÃ¡ginas: {{ question.paginas }}
            </span>
          </div>

          <!-- Status da Resposta -->
          <div class="answer-status">
            <div *ngIf="question.uniqueKey && !isQuestionAnswered(question.uniqueKey)" class="status-badge not-answered">
              â³ NÃ£o respondida
            </div>
            <div *ngIf="question.uniqueKey && getQuestionAnswerStatus(question.uniqueKey) === 'correct'" class="status-badge correct">
              âœ… Correta
            </div>
            <div *ngIf="question.uniqueKey && getQuestionAnswerStatus(question.uniqueKey) === 'incorrect'" class="status-badge incorrect">
              âŒ Incorreta
            </div>
          </div>
        </div>

        <!-- ConteÃºdo da QuestÃ£o -->
        <div class="questao-content">
          <h4 class="questao-pergunta">{{ question.pergunta }}</h4>

          <!-- Pergunta Verdadeiro/Falso - Componente EspecÃ­fico -->
          <app-pergunta-v-f
            *ngIf="question.tipo === 'vf'"
            [questionId]="question.id"
            [questionData]="getVFData(question)"
            [isAnswered]="questionResults[question.uniqueKey!]?.answered || false"
            [isCorrect]="questionResults[question.uniqueKey!]?.isCorrect || false"
            (answerSubmitted)="onAnswerSubmitted($event)"
          ></app-pergunta-v-f>

          <!-- Pergunta MÃºltipla Escolha - Componente EspecÃ­fico -->
          <app-pergunta-multipla
            *ngIf="question.tipo === 'multipla'"
            [questionId]="question.id"
            [questionData]="getMultiplaData(question)"
            [isAnswered]="questionResults[question.uniqueKey!]?.answered || false"
            [isCorrect]="questionResults[question.uniqueKey!]?.isCorrect || false"
            (answerSubmitted)="onAnswerSubmitted($event)"
          ></app-pergunta-multipla>

          <!-- Pergunta de CorrelaÃ§Ã£o - Componente EspecÃ­fico -->
          <app-pergunta-correlacao
            *ngIf="question.tipo === 'correlacao'"
            [questionId]="question.id"
            [questionData]="getCorrelacaoData(question)"
            [isAnswered]="questionResults[question.uniqueKey!]?.answered || false"
            [isCorrect]="questionResults[question.uniqueKey!]?.isCorrect || false"
            (answerSubmitted)="onAnswerSubmitted($event)"
          ></app-pergunta-correlacao>

        </div>
      </div>
    </div>

    <!-- Resumo Final -->
    <div *ngIf="getTotalAnsweredQuestions() > 0" class="resumo-final">
      <h3>ğŸ“Š Resumo da Prova</h3>
      <div class="resumo-stats">
        <div class="stat-card">
          <span class="stat-value">{{ getTotalAnsweredQuestions() }}</span>
          <span class="stat-label">QuestÃµes Respondidas</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">{{ getTotalCorrectAnswers() }}</span>
          <span class="stat-label">Acertos</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">{{ getScorePercentage().toFixed(1) }}%</span>
          <span class="stat-label">Performance</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Mensagem se nÃ£o hÃ¡ questÃµes -->
  <div *ngIf="!questionsLoaded && !isLoadingQuestions" class="no-questions">
    <h3>ğŸ¤” Nenhuma prova carregada</h3>
    <p>Configure as bibliografias e gere uma nova prova.</p>
    <button class="btn btn-primary" (click)="gerarNovaProva()">
      ğŸš€ Gerar Prova
    </button>
  </div>

</div>