<div class="conceitos-container">

  <!-- Header: t√≠tulo + stats + filtros + navega√ß√£o (inspirado em Flash Cards) -->
  <header *ngIf="showHeader" class="header-generic-content" role="banner">
    <div class="header">
      <h2>{{ moduleEmoji ? (moduleEmoji + ' ') : '' }}{{ moduleLabel || 'Conceitos' }}</h2>
      <div class="stats" *ngIf="!isLoading">
        <span class="stat-item">
          <strong>{{ filteredConceitos.length }}</strong> de <strong>{{ conceitos.length }}</strong> conceitos
        </span>
        <span class="stat-item">
          <strong>{{ bibliografias.length }}</strong> {{ bibliografias.length === 1 ? 'bibliografia' : 'bibliografias' }}
        </span>
      </div>
    </div>



    <!-- Bot√µes de navega√ß√£o (preservados) -->
    <nav class="navigation-buttons" aria-label="Navega√ß√£o" *ngIf="!isLoading">
      <button class="btn btn-stroked" (click)="navigateTo(getPath('bibliografia'))" aria-label="Voltar para Bibliografia">
        ‚¨ÖÔ∏è Voltar √† Bibliografia
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('flash-cards'))" aria-label="Flashcards">
        üìá Flashcards
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('media'))" aria-label="Media">
        ‚ñ∂Ô∏è Media
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('perguntas'))" aria-label="Perguntas">
        ‚ùì Perguntas
      </button>
      <button class="btn btn-stroked" (click)="navigateTo(getPath('conceitos'))" aria-label="Conceitos">
        üß≠ Conceitos
      </button>
    </nav>
  </header>

  <!-- Loading state -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <p class="loading-text">Carregando conceitos...</p>
  </div>

  <!-- Error state -->
  <div class="error-state" *ngIf="error && !loading">
    <div class="error-icon">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    </div>
    <p class="error-message">{{ error }}</p>
    <button 
      class="retry-button" 
      (click)="loadConceitos()">
      Tentar novamente
    </button>
  </div>

    </div>
  <!-- Content with tabs -->
  <div *ngIf="!loading && !error" class="content-container">
        <!-- Filtros (Bibliografia + Assunto) -->
    <div class="filters-section" *ngIf="!isLoading">
      <div class="filter-row">
        <div class="filter-group">
          <label for="bibliografia-filter">üìñ Bibliografia:</label>
          <select
            id="bibliografia-filter"
            name="bibliografia"
            [(ngModel)]="selectedBibliografiaId"
            (ngModelChange)="onBibliografiaChange()"
            class="filter-select">
            <option [ngValue]="null">Todas as Bibliografias</option>
            <option *ngFor="let bib of bibliografias" [ngValue]="bib.id">{{ bib.titulo }}</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="assunto-filter">üè∑Ô∏è Assunto:</label>
          <select
            id="assunto-filter"
            name="assunto"
            [(ngModel)]="selectedAssunto"
            (ngModelChange)="onAssuntoChange()"
            class="filter-select"
            [disabled]="assuntosDisponiveis.length === 0">
            <option value="">Todos os assuntos</option>
            <option *ngFor="let assunto of assuntosDisponiveis" [value]="assunto">{{ assunto }}</option>
          </select>
        </div>
      <div class="actions-row">
        <button class="btn btn-outline" (click)="resetFilters()" [disabled]="!selectedBibliografiaId && !selectedAssunto">‚úñÔ∏è Limpar Filtros</button>
      </div>        
      </div>



    <!-- Conceitos table -->
    <app-conceitos-table 
      [conceitos]="filteredConceitos"
      [title]="!showHeader ? (bibliografias.length <= 1 ? 'Conceitos' : 'Conceitos da Bibliografia') : ''"
      [showBibliografia]="bibliografias.length <= 1"
      [emptyMessage]="getEmptyMessage()">
    </app-conceitos-table>
  </div>
</div>
