<div class="livro-container">
  
  <!-- Menu Lateral Esquerdo - Arquivos -->
  <aside class="left-menu">
    
    <!-- Header do Menu Esquerdo -->
    <div class="menu-header">
      <!-- Bot√£o de Voltar -->
      <button 
        *ngIf="backRoute"
        mat-icon-button 
        class="back-button"
        (click)="navigateBack()"
        [matTooltip]="'Voltar para ' + backLabel"
        matTooltipPosition="right"
        aria-label="Voltar">
        <mat-icon>arrow_back</mat-icon>
      </button>
    </div>

    <!-- Conte√∫do do Menu Esquerdo -->
    <div class="menu-content">
      <div class="menu-title-container">
        <h3 class="menu-title">Arquivos</h3>
      </div>
      
      <mat-nav-list>
        <mat-list-item 
          *ngFor="let file of markdownFiles"
          [class.active]="selectedFile?.fileName === file.fileName"
          (click)="selectFile(file)">
          <mat-icon matListItemIcon>description</mat-icon>
          <div matListItemTitle class="file-title-wrapper">
            <span class="file-title">{{ file.title }}</span>
          </div>
        </mat-list-item>
      </mat-nav-list>
    </div>

  </aside>

  <!-- √Årea de Conte√∫do Central -->
  <main class="content-area">
    
    <!-- Bot√£o de Tela Cheia -->
    <div class="fullscreen-button-container" *ngIf="!isLoading && selectedFile">
      <button 
        class="btn btn-fullscreen"
        (click)="openFullscreen()"
        [disabled]="!selectedFile">
        üñ•Ô∏è Tela Cheia
      </button>
    </div>
    
    <!-- Loading Spinner -->
    <div class="loading-container" *ngIf="isLoading">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Carregando conte√∫do...</p>
    </div>

    <!-- Conte√∫do do Markdown -->
    <div class="markdown-content" *ngIf="!isLoading && selectedFile">
      <div class="content-wrapper" [innerHTML]="htmlContent"></div>
    </div>

    <!-- Mensagem quando n√£o h√° arquivo selecionado -->
    <div class="no-content" *ngIf="!isLoading && !selectedFile">
      <mat-icon>description</mat-icon>
      <p>Nenhum arquivo selecionado</p>
      <p class="subtitle">Selecione um arquivo no menu lateral</p>
    </div>

  </main>

  <!-- Menu Lateral Direito - √çndice -->
  <aside class="right-menu">
    
    <!-- Header do Menu Direito -->
    <div class="menu-header">
      <!-- Espa√ßo reservado para manter consist√™ncia visual -->
    </div>

    <!-- Conte√∫do do Menu Direito -->
    <div class="menu-content">
      <div class="menu-title-container">
        <h3 class="menu-title">√çndice</h3>
      </div>
      
      <div class="headings-tree" *ngIf="headings.length > 0">
        
        <!-- N√≠vel 1 (H1) -->
        <ng-container *ngFor="let h1 of headings">
          <div class="heading-item level-1">
            
            <div class="heading-content" (click)="navigateToHeading(h1)">
              <mat-icon class="heading-icon">{{ getHeadingIcon(h1) }}</mat-icon>
              <span class="heading-title">{{ h1.title }}</span>
            </div>

            <!-- N√≠vel 2 (H2) - Filhos do H1 -->
            <div class="heading-children" *ngIf="isExpanded(h1) && h1.children && h1.children.length > 0">
              <ng-container *ngFor="let h2 of h1.children">
                <div class="heading-item level-2">
                  
                  <div class="heading-content" (click)="navigateToHeading(h2)">
                    <mat-icon class="heading-icon">{{ getHeadingIcon(h2) }}</mat-icon>
                    <span class="heading-title">{{ h2.title }}</span>
                  </div>

                  <!-- N√≠vel 3 (H3) - Filhos do H2 -->
                  <div class="heading-children" *ngIf="isExpanded(h2) && h2.children && h2.children.length > 0">
                    <ng-container *ngFor="let h3 of h2.children">
                      <div class="heading-item level-3">
                        
                        <div class="heading-content" (click)="navigateToHeading(h3)">
                          <mat-icon class="heading-icon">article</mat-icon>
                          <span class="heading-title">{{ h3.title }}</span>
                        </div>

                      </div>
                    </ng-container>
                  </div>

                </div>
              </ng-container>
            </div>

          </div>
        </ng-container>

      </div>
      
      <div class="no-headings" *ngIf="headings.length === 0">
        <p>Nenhum √≠ndice dispon√≠vel</p>
      </div>
    </div>

  </aside>

  <!-- Fullscreen Overlay -->
  <div class="fullscreen-overlay" *ngIf="isFullscreen">
    <div class="fullscreen-container">
      <!-- Menu Lateral Esquerdo - Arquivos (Fullscreen) -->
      <aside class="left-menu fullscreen-menu">
        <div class="menu-header">
          <button 
            *ngIf="backRoute"
            mat-icon-button 
            class="back-button"
            (click)="navigateBack()"
            [matTooltip]="'Voltar para ' + backLabel"
            matTooltipPosition="right"
            aria-label="Voltar">
            <mat-icon>arrow_back</mat-icon>
          </button>
        </div>
        <div class="menu-content">
          <div class="menu-title-container">
            <h3 class="menu-title">Arquivos</h3>
          </div>
          <mat-nav-list>
            <mat-list-item 
              *ngFor="let file of markdownFiles"
              [class.active]="selectedFile?.fileName === file.fileName"
              (click)="selectFile(file)">
              <mat-icon matListItemIcon>description</mat-icon>
              <div matListItemTitle class="file-title-wrapper">
                <span class="file-title">{{ file.title }}</span>
              </div>
            </mat-list-item>
          </mat-nav-list>
        </div>
      </aside>

      <!-- √Årea de Conte√∫do Central (Fullscreen) -->
      <main class="fullscreen-content-area">
        <div class="fullscreen-header">
          <h3>{{ selectedFile?.title || 'Conte√∫do' }} - Modo Tela Cheia</h3>
          <button 
            class="btn-close-fullscreen"
            (click)="exitFullscreen()"
            aria-label="Fechar tela cheia">
            ‚úï
          </button>
        </div>
        
        <div class="fullscreen-content">
          <div class="content-wrapper" [innerHTML]="htmlContent"></div>
        </div>
        
        <div class="fullscreen-actions">
          <button 
            class="btn btn-outline"
            (click)="exitFullscreen()">
            ‚úñÔ∏è Fechar (ESC)
          </button>
        </div>
      </main>

      <!-- Menu Lateral Direito - √çndice (Fullscreen) -->
      <aside class="right-menu fullscreen-menu">
        <div class="menu-header">
          <!-- Espa√ßo reservado para manter consist√™ncia visual -->
        </div>
        <div class="menu-content">
          <div class="menu-title-container">
            <h3 class="menu-title">√çndice</h3>
          </div>
          <div class="headings-tree" *ngIf="headings.length > 0">
            <ng-container *ngFor="let h1 of headings">
              <div class="heading-item level-1">
                <div class="heading-content" (click)="navigateToHeading(h1)">
                  <mat-icon class="heading-icon">{{ getHeadingIcon(h1) }}</mat-icon>
                  <span class="heading-title">{{ h1.title }}</span>
                </div>
                <div class="heading-children" *ngIf="isExpanded(h1) && h1.children && h1.children.length > 0">
                  <ng-container *ngFor="let h2 of h1.children">
                    <div class="heading-item level-2">
                      <div class="heading-content" (click)="navigateToHeading(h2)">
                        <mat-icon class="heading-icon">{{ getHeadingIcon(h2) }}</mat-icon>
                        <span class="heading-title">{{ h2.title }}</span>
                      </div>
                      <div class="heading-children" *ngIf="isExpanded(h2) && h2.children && h2.children.length > 0">
                        <ng-container *ngFor="let h3 of h2.children">
                          <div class="heading-item level-3">
                            <div class="heading-content" (click)="navigateToHeading(h3)">
                              <mat-icon class="heading-icon">article</mat-icon>
                              <span class="heading-title">{{ h3.title }}</span>
                            </div>
                          </div>
                        </ng-container>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </div>
            </ng-container>
          </div>
          <div class="no-headings" *ngIf="headings.length === 0">
            <p>Nenhum √≠ndice dispon√≠vel</p>
          </div>
        </div>
      </aside>
    </div>
  </div>

</div>
