import pandas as pd
from pathlib import Path

def markdown_to_xlsx(markdown_text: str, output_name: str = "tabela_convertida.xlsx"):
    # Divide linhas e remove espaços extras
    lines = [line.strip() for line in markdown_text.strip().splitlines() if line.strip()]
    
    # Encontra cabeçalhos e linhas de dados
    header = [col.strip() for col in lines[0].strip('|').split('|')]
    data_lines = [line for line in lines[2:] if line.startswith('|')]
    
    # Processa as linhas em listas
    data = []
    for line in data_lines:
        row = [col.strip() for col in line.strip('|').split('|')]
        data.append(row)
    
    # Cria DataFrame
    df = pd.DataFrame(data, columns=header)
    
    # Salva em XLSX no mesmo diretório do script
    path = Path(__file__).resolve().parent / output_name
    df.to_excel(path, index=False)
    print(f"✅ Arquivo gerado com sucesso: {path}")

if __name__ == "__main__":
    markdown_text = """
| bibliografia_titulo | paginas | assunto | afirmacao_verdadeira | afirmacao_falsa | justificativa_resposta_certa | caiu_em_prova | ano_prova |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Bibliografia 1 – Modernidade | | Impacto da modernidade na Geopolítica. | O ramo **geográfico** da Geopolítica foi o que recebeu o maior impacto modificador provocado pela modernidade e pelos avanços da tecnologia. | O ramo político da Geopolítica foi o que recebeu o maior impacto modificador provocado pela modernidade e pelos avanços da tecnologia. | O ramo geográfico foi o mais impactado, conforme a síntese da apreciação do efeito da modernidade sobre os três ramos da Geopolítica. | | |
| Bibliografia 1 – Modernidade | | Componentes da Geopolítica. | A Geopolítica é composta por três principais ramos de conhecimento: o geográfico, o político e o histórico. | A Geopolítica é composta apenas pelos ramos geográfico e político, sendo o histórico um elemento secundário. | O geográfico, o político e o histórico são os três ramos científicos formadores da Geopolítica. | | |
| Bibliografia 1 – Modernidade | | Tecnologia e uso do meio geográfico. | A **engenharia de transportes**, as **telecomunicações** e a **informática** foram as três áreas tecnológicas que mais favoreceram o uso do meio geográfico pelo homem no último século. | A engenharia civil, a robótica e a nanotecnologia foram as áreas tecnológicas que mais favoreceram o uso do meio geográfico. | A engenharia de transportes, telecomunicações e informática são explicitamente citadas como os novos recursos que favoreceram o uso do meio geográfico. | | |
| Bibliografia 1 – Modernidade | | Efeitos da tecnologia na distância e comunicação. | Os avanços tecnológicos encurtaram as distâncias e tornaram a informação visual e sonora quase instantânea em escala planetária. | Os avanços tecnológicos aumentaram as distâncias percebidas, mas tornaram o tempo de comunicação mais lento. | A tecnologia causou o encurtamento drástico das distâncias e a quase instantaneidade da comunicação da imagem e do som. | | |
| Bibliografia 1 – Modernidade | | Novas vias de exploração geográfica. | Os meios eletrônicos abriram uma nova via de exploração do espaço geográfico, chamada **via vertical**, para a transmissão de mensagens e imagens. | A via horizontal é a única via de exploração do espaço geográfico, visto que a via vertical é utilizada apenas para satélites militares. | A via vertical foi a nova via aberta pelos meios eletrônicos para o trânsito de mensagens e imagens, complementando a exploração horizontal. | | |
| Bibliografia 1 – Modernidade | | Fatores políticos do meio geográfico. | Os dois fatores principais considerados na utilização política do meio geográfico são sua **extensão** e sua **posição**. | Os dois fatores principais na utilização política do meio geográfico são o clima e a natureza do solo. | A extensão e a posição são os dois fatores principais do meio geográfico que influenciam sua potencialização política. | | |
| Bibliografia 1 – Modernidade | | Peso da extensão territorial. | O peso político do valor da extensão de um território é de natureza **quantitativa**. | O peso político do valor da extensão de um território é de natureza qualitativa. | A extensão do território é associada ao peso político quantitativo. | | |
| Bibliografia 1 – Modernidade | | Determinação do peso quantitativo. | O peso político quantitativo da extensão de um território é determinado pela **população** e pelas **riquezas naturais** que ele pode abrigar. | O peso político quantitativo da extensão de um território é determinado pelo seu clima e sua localização geodésica. | O peso quantitativo da extensão é dado pela população e pelas riquezas naturais que o território pode abrigar. | | |
| Bibliografia 1 – Modernidade | | Peso da posição territorial. | O valor da posição de um território é associado a um peso político de natureza **qualitativa**. | O valor da posição de um território é associado a um peso político de natureza quantitativa. | A posição do território é associada ao peso político qualitativo. | | |
| Bibliografia 1 – Modernidade | | Localização geodésica e clima. | A localização geodésica de um território é importante para seu peso qualitativo porque determina as **condições climáticas**. | A localização geodésica de um território é importante para seu peso quantitativo porque determina a natureza do solo. | A localização geodésica é um fator do peso qualitativo por determinar as condições climáticas do território. | | |
| Bibliografia 1 – Modernidade | | Características do peso qualitativo. | A natureza do solo, a maritimidade ou continentalidade, e a localização relativa a centros de poder são características que definem o peso qualitativo da posição de um território. | A extensão territorial e o número de fronteiras são características que definem o peso qualitativo da posição de um território. | O peso qualitativo é apreciado pela localização geodésica, natureza do solo, maritimidade/continentalidade e localização relativa a outros centros de poder. | | |
| Bibliografia 1 – Modernidade | | Impacto da tecnologia no binômio espaço-tempo. | O fator **tempo** foi o elemento do binômio espaço-tempo mais intensamente atingido pela tecnologia moderna. | O fator espaço foi o elemento do binômio espaço-tempo mais intensamente atingido pela tecnologia moderna. | A tecnologia moderna volatilizar o fator tempo, impactando-o mais intensamente que o fator espaço. | | |
| Bibliografia 1 – Modernidade | | Volatilização do tempo. | A tecnologia moderna, ao permitir a comunicação instantânea e encurtar as distâncias, **volatilizou** o fator tempo. | A tecnologia moderna solidificou o fator tempo, tornando-o mais estável em relação ao espaço. | A quase instantaneidade da comunicação e o encurtamento das distâncias pelos novos meios de transporte volatilizaram o fator tempo. | | |
| Bibliografia 1 – Modernidade | | Conceito de espaço e tempo (Descartes). | O filósofo citado no texto por afirmar que "**O espaço é concreto, o tempo não**" é **Descartes**. | Santo Agostinho é o filósofo citado no texto por afirmar que "O espaço é concreto, o tempo não". | Descartes é o pensador citado que percebeu a maior estabilidade do espaço ao afirmar que "O espaço é concreto, o tempo não". | | |
| Bibliografia 1 – Modernidade | | Tempo e Santo Agostinho. | **Santo Agostinho** abordou as três divisões do tempo no livro "**As Confissões**", impressionado com sua fugacidade. | Einstein abordou a fugacidade do tempo e suas três divisões no livro "As Confissões". | Santo Agostinho foi o pensador que se impressionou com a fugacidade do tempo e abordou suas divisões em "As Confissões". | | |
| Bibliografia 1 – Modernidade | | Relatividade do tempo. | **Einstein** é o filósofo recente citado no texto por considerar a relatividade do tempo. | Lucien Febvres é o filósofo recente citado no texto por considerar a relatividade do tempo. | Einstein é citado no texto como o filósofo que considerou a relatividade do tempo. | | |
| Bibliografia 1 – Modernidade | | Estabilidade do binômio espaço-tempo. | O **espaço** tem se apresentado como o fator mais estável dentro do binômio espaço-tempo. | O tempo tem se apresentado como o fator mais estável dentro do binômio espaço-tempo. | O espaço é considerado o fator mais estável do binômio, enquanto o tempo foi volatilizado pela tecnologia. | | |
| Bibliografia 1 – Modernidade | | Inovações tecnológicas (Séculos XIX/XX). | O **avião**, os **satélites**, o **rádio** e a **televisão** são exemplos de inovações tecnológicas do século XX que não existiam no século XIX. | O trem a vapor e o telégrafo são inovações citadas que surgiram no século XX, não existindo no século XIX. | O avião, os satélites, o rádio, a televisão, a eletrônica, o fax, a informática e a energia nuclear são listadas como inovações que se incorporaram ao patrimônio do conhecimento no século XX. | | |
| Bibliografia 1 – Modernidade | | Ação do homem tecnotrônico. | O homem tecnotrônico moderno invade o espaço de todos os quadrantes do planeta utilizando **modernos meios de comunicação** para enviar mensagens faladas e escritas. | O homem tecnotrônico moderno invade o espaço de todos os quadrantes do planeta através da expansão territorial e colonização. | A invasão do espaço global pelo homem tecnotrônico se dá através dos modernos meios de comunicação e suas mensagens faladas e escritas. | | |
| Bibliografia 1 – Modernidade | | Contribuições históricas (França). | **Lucien Febvres** é o historiador francês mencionado como uma contribuição para o enriquecimento da História no pensamento geopolítico moderno. | O historiador francês mencionado como contribuição para o pensamento geopolítico moderno é Toynbee. | Lucien Febvres é o historiador francês citado cujas obras enriqueceram a História, um dos ramos formadores da Geopolítica. | | |
| Bibliografia 1 – Modernidade | | Contribuições históricas (EUA). | **Barbara Tuchman** é a historiadora norte-americana citada por seu estilo modernizante que enriqueceu a História no contexto da Geopolítica. | A historiadora norte-americana citada por seu estilo modernizante é Margaret Thatcher. | Barbara Tuchman é a historiadora norte-americana cujo estilo modernizante foi um enriquecimento para a História, ramo da Geopolítica. | | |
| Bibliografia 1 – Modernidade | | Vitalidade da Geopolítica. | Após a modernidade, **os três ramos científicos** formadores da Geopolítica saíram enriquecidos, assegurando sua plena vitalidade. | Após a modernidade, apenas o ramo geográfico saiu enriquecido, enquanto o político e o histórico perderam relevância para a Geopolítica. | A modernidade enriqueceu os três ramos científicos da Geopolítica (geográfico, político e histórico), garantindo sua plena vitalidade. | | |"""
    
    markdown_to_xlsx(markdown_text)
